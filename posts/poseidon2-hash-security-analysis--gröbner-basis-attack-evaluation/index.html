<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Poseidon2 Hash Security Analysis: Gröbner Basis Attack Evaluation | Sidereus Hu</title>
<meta name="keywords" content="">
<meta name="description" content="

  
      
          Work
          Key Idea
          Effectiveness on Poseidon
      
  
  
      
          [FP20]
          Closed-form degree expression
          Useful for modeling GB attacks
      
      
          [BBLP22]
          Skipping (multiple) full rounds
          Reduces effective non-linear depth
      
      
          [ABM24]
          Round-level GB modeling
          Shows underestimated vulnerability at κ = 1024
      
      
          [BBL&#43;24]
          FreeLunch GB attacks
          Not effective due to low S-box degree
      
      
          [KLR24]
          &ldquo;Six Worlds&rdquo; framework
          Not yet applied; potential for future work
      
      
          [GKR25]
          Forward GB Attack Exploiting Subspace Trails
          original analysis under- or overestimates the number of rounds needed for security.
      
      
          [BBB&#43;25]
          Iterated resultants
          Reduces to simple univariate case
      
  


Key Points

Evolution of Attack Methods: Beyond traditional analytical approaches such as statistical analysis, algebraic attacks (particularly Gröbner basis attacks) have been recognized by the academic community as significantly more effective and have become the primary research focus in recent years.
Parameter Customization Challenges: Poseidon hash offers extensive customizable parameter space, which leads to issues of conservative security assumptions and potential overestimation.
Current Research Status: The results provided by [ABM24] are excellent, but their acceptance in the community remains limited at present.

In [GKR25], the authors present a comprehensive analysis of Gröbner basis attacks against Poseidon2 in Sponge mode through Table 5. This analysis is based on a two-step approach: the GB step (Macaulay bound) and the FGLM step (conjectured dI). Subsequently, the authors derive the minimum partial rounds values $r_P$ that can be configured, as shown in Table 3.">
<meta name="author" content="Sidereus Hu">
<link rel="canonical" href="https://sidereushu.github.io/posts/poseidon2-hash-security-analysis--gr%C3%B6bner-basis-attack-evaluation/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.93f625d739f1d6a5c6f20c146bc6a8d26b233492b34b2220c54b12fd46a04ded.css" integrity="sha256-k/Yl1znx1qXG8gwUa8ao0msjNJKzSyIgxUsS/UagTe0=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://sidereushu.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://sidereushu.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://sidereushu.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://sidereushu.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://sidereushu.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://sidereushu.github.io/posts/poseidon2-hash-security-analysis--gr%C3%B6bner-basis-attack-evaluation/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
  
<script>
  MathJax = {
    tex: {
      inlineMath: [['\\(', '\\)'], ['$', '$']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
 


<meta property="og:url" content="https://sidereushu.github.io/posts/poseidon2-hash-security-analysis--gr%C3%B6bner-basis-attack-evaluation/">
  <meta property="og:site_name" content="Sidereus Hu">
  <meta property="og:title" content="Poseidon2 Hash Security Analysis: Gröbner Basis Attack Evaluation">
  <meta property="og:description" content="
Work Key Idea Effectiveness on Poseidon [FP20] Closed-form degree expression Useful for modeling GB attacks [BBLP22] Skipping (multiple) full rounds Reduces effective non-linear depth [ABM24] Round-level GB modeling Shows underestimated vulnerability at κ = 1024 [BBL&#43;24] FreeLunch GB attacks Not effective due to low S-box degree [KLR24] “Six Worlds” framework Not yet applied; potential for future work [GKR25] Forward GB Attack Exploiting Subspace Trails original analysis under- or overestimates the number of rounds needed for security. [BBB&#43;25] Iterated resultants Reduces to simple univariate case Key Points Evolution of Attack Methods: Beyond traditional analytical approaches such as statistical analysis, algebraic attacks (particularly Gröbner basis attacks) have been recognized by the academic community as significantly more effective and have become the primary research focus in recent years. Parameter Customization Challenges: Poseidon hash offers extensive customizable parameter space, which leads to issues of conservative security assumptions and potential overestimation. Current Research Status: The results provided by [ABM24] are excellent, but their acceptance in the community remains limited at present. In [GKR25], the authors present a comprehensive analysis of Gröbner basis attacks against Poseidon2 in Sponge mode through Table 5. This analysis is based on a two-step approach: the GB step (Macaulay bound) and the FGLM step (conjectured dI). Subsequently, the authors derive the minimum partial rounds values $r_P$ that can be configured, as shown in Table 3.">
  <meta property="og:locale" content="zh-cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-08-09T16:57:25+08:00">
    <meta property="article:modified_time" content="2025-08-09T16:57:25+08:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Poseidon2 Hash Security Analysis: Gröbner Basis Attack Evaluation">
<meta name="twitter:description" content="

  
      
          Work
          Key Idea
          Effectiveness on Poseidon
      
  
  
      
          [FP20]
          Closed-form degree expression
          Useful for modeling GB attacks
      
      
          [BBLP22]
          Skipping (multiple) full rounds
          Reduces effective non-linear depth
      
      
          [ABM24]
          Round-level GB modeling
          Shows underestimated vulnerability at κ = 1024
      
      
          [BBL&#43;24]
          FreeLunch GB attacks
          Not effective due to low S-box degree
      
      
          [KLR24]
          &ldquo;Six Worlds&rdquo; framework
          Not yet applied; potential for future work
      
      
          [GKR25]
          Forward GB Attack Exploiting Subspace Trails
          original analysis under- or overestimates the number of rounds needed for security.
      
      
          [BBB&#43;25]
          Iterated resultants
          Reduces to simple univariate case
      
  


Key Points

Evolution of Attack Methods: Beyond traditional analytical approaches such as statistical analysis, algebraic attacks (particularly Gröbner basis attacks) have been recognized by the academic community as significantly more effective and have become the primary research focus in recent years.
Parameter Customization Challenges: Poseidon hash offers extensive customizable parameter space, which leads to issues of conservative security assumptions and potential overestimation.
Current Research Status: The results provided by [ABM24] are excellent, but their acceptance in the community remains limited at present.

In [GKR25], the authors present a comprehensive analysis of Gröbner basis attacks against Poseidon2 in Sponge mode through Table 5. This analysis is based on a two-step approach: the GB step (Macaulay bound) and the FGLM step (conjectured dI). Subsequently, the authors derive the minimum partial rounds values $r_P$ that can be configured, as shown in Table 3.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://sidereushu.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Poseidon2 Hash Security Analysis: Gröbner Basis Attack Evaluation",
      "item": "https://sidereushu.github.io/posts/poseidon2-hash-security-analysis--gr%C3%B6bner-basis-attack-evaluation/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Poseidon2 Hash Security Analysis: Gröbner Basis Attack Evaluation",
  "name": "Poseidon2 Hash Security Analysis: Gröbner Basis Attack Evaluation",
  "description": "\nWork Key Idea Effectiveness on Poseidon [FP20] Closed-form degree expression Useful for modeling GB attacks [BBLP22] Skipping (multiple) full rounds Reduces effective non-linear depth [ABM24] Round-level GB modeling Shows underestimated vulnerability at κ = 1024 [BBL+24] FreeLunch GB attacks Not effective due to low S-box degree [KLR24] \u0026ldquo;Six Worlds\u0026rdquo; framework Not yet applied; potential for future work [GKR25] Forward GB Attack Exploiting Subspace Trails original analysis under- or overestimates the number of rounds needed for security. [BBB+25] Iterated resultants Reduces to simple univariate case Key Points Evolution of Attack Methods: Beyond traditional analytical approaches such as statistical analysis, algebraic attacks (particularly Gröbner basis attacks) have been recognized by the academic community as significantly more effective and have become the primary research focus in recent years. Parameter Customization Challenges: Poseidon hash offers extensive customizable parameter space, which leads to issues of conservative security assumptions and potential overestimation. Current Research Status: The results provided by [ABM24] are excellent, but their acceptance in the community remains limited at present. In [GKR25], the authors present a comprehensive analysis of Gröbner basis attacks against Poseidon2 in Sponge mode through Table 5. This analysis is based on a two-step approach: the GB step (Macaulay bound) and the FGLM step (conjectured dI). Subsequently, the authors derive the minimum partial rounds values $r_P$ that can be configured, as shown in Table 3.\n",
  "keywords": [
    
  ],
  "articleBody": "\nWork Key Idea Effectiveness on Poseidon [FP20] Closed-form degree expression Useful for modeling GB attacks [BBLP22] Skipping (multiple) full rounds Reduces effective non-linear depth [ABM24] Round-level GB modeling Shows underestimated vulnerability at κ = 1024 [BBL+24] FreeLunch GB attacks Not effective due to low S-box degree [KLR24] “Six Worlds” framework Not yet applied; potential for future work [GKR25] Forward GB Attack Exploiting Subspace Trails original analysis under- or overestimates the number of rounds needed for security. [BBB+25] Iterated resultants Reduces to simple univariate case Key Points Evolution of Attack Methods: Beyond traditional analytical approaches such as statistical analysis, algebraic attacks (particularly Gröbner basis attacks) have been recognized by the academic community as significantly more effective and have become the primary research focus in recent years. Parameter Customization Challenges: Poseidon hash offers extensive customizable parameter space, which leads to issues of conservative security assumptions and potential overestimation. Current Research Status: The results provided by [ABM24] are excellent, but their acceptance in the community remains limited at present. In [GKR25], the authors present a comprehensive analysis of Gröbner basis attacks against Poseidon2 in Sponge mode through Table 5. This analysis is based on a two-step approach: the GB step (Macaulay bound) and the FGLM step (conjectured dI). Subsequently, the authors derive the minimum partial rounds values $r_P$ that can be configured, as shown in Table 3.\nNote: While the authors provide analysis data for both Sponge mode (Table 5) and Compress mode (Table 6), they only provide partial rounds settings similar to Table 3 for the Sponge mode. Based on the data from Table 6 and combining the Gröbner basis attack complexity formula $(d_{MAC})^{\\omega}$ with $\\omega = 2$ as used in Table 3, we perform the following calculations:\nSecurity Threshold Calculation To achieve 128-bit security, we need to satisfy:\n$$(d_{MAC})^2 \\geq 2^{128}$$Taking the square root of both sides, we get the requirement for the Macaulay Bound $d_{MAC}$:\n$$d_{MAC} \\geq 2^{64}$$Taking the logarithm, we obtain our required security threshold:\n$$\\log_2(d_{MAC}) \\geq 64$$Any parameter configuration where $\\log_2(d_{MAC})$ is greater than or equal to 64 can be considered secure against this attack.\nAnalysis from Table 5 Now, let’s examine Table 5 (a) GB step. This table demonstrates how various complexity indicators change when the number of partial rounds $r_P$ increases from 1 to 5, for fixed parameters $t$, $d$, $c$. We focus particularly on the Macaulay bound d_MAC row, where the values in parentheses represent the pre-calculated $\\log_2(d_{MAC})$ values.\nTaking the first row of Table 5 as an example, with parameters $t=3$, $d=1$, $c=1$, $\\ell=1$:\nWhen $r_P = 1$: $\\log_2(d_{MAC}) = 27$ (\u003c 64, not secure) When $r_P = 2$: $\\log_2(d_{MAC}) = 33$ (\u003c 64, not secure) When $r_P = 3$: $\\log_2(d_{MAC}) = 51$ (\u003c 64, not secure) When $r_P = 4$: $\\log_2(d_{MAC}) = 87$ (\u003e 64, secure) When $r_P = 5$: $\\log_2(d_{MAC}) = 105$ (\u003e 64, secure) Conclusion For the parameter set $t=3$, $d=1$, $c=1$, $\\ell=1$, only 4 partial rounds are required to elevate the complexity of the most powerful Gröbner basis subspace optimization attack above the 128-bit security level.\n",
  "wordCount" : "506",
  "inLanguage": "zh",
  "datePublished": "2025-08-09T16:57:25+08:00",
  "dateModified": "2025-08-09T16:57:25+08:00",
  "author":{
    "@type": "Person",
    "name": "Sidereus Hu"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://sidereushu.github.io/posts/poseidon2-hash-security-analysis--gr%C3%B6bner-basis-attack-evaluation/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Sidereus Hu",
    "logo": {
      "@type": "ImageObject",
      "url": "https://sidereushu.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://sidereushu.github.io/" accesskey="h" title="Sidereus Hu (Alt + H)">Sidereus Hu</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://sidereushu.github.io/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://sidereushu.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Poseidon2 Hash Security Analysis: Gröbner Basis Attack Evaluation
    </h1>
    <div class="post-meta"><span title='2025-08-09 16:57:25 +0800 CST'>2025-08-09</span>&nbsp;·&nbsp;Sidereus Hu

</div>
  </header> 
  <div class="post-content"><br>
<table>
  <thead>
      <tr>
          <th>Work</th>
          <th>Key Idea</th>
          <th>Effectiveness on Poseidon</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>[FP20]</strong></td>
          <td>Closed-form degree expression</td>
          <td>Useful for modeling GB attacks</td>
      </tr>
      <tr>
          <td><strong>[BBLP22]</strong></td>
          <td>Skipping (multiple) full rounds</td>
          <td>Reduces effective non-linear depth</td>
      </tr>
      <tr>
          <td><strong>[ABM24]</strong></td>
          <td>Round-level GB modeling</td>
          <td>Shows underestimated vulnerability at κ = 1024</td>
      </tr>
      <tr>
          <td><strong>[BBL+24]</strong></td>
          <td>FreeLunch GB attacks</td>
          <td>Not effective due to low S-box degree</td>
      </tr>
      <tr>
          <td><strong>[KLR24]</strong></td>
          <td>&ldquo;Six Worlds&rdquo; framework</td>
          <td>Not yet applied; potential for future work</td>
      </tr>
      <tr>
          <td><strong>[GKR25]</strong></td>
          <td>Forward GB Attack Exploiting Subspace Trails</td>
          <td>original analysis under- or overestimates the number of rounds needed for security.</td>
      </tr>
      <tr>
          <td><strong>[BBB+25]</strong></td>
          <td>Iterated resultants</td>
          <td>Reduces to simple univariate case</td>
      </tr>
  </tbody>
</table>
<br>
<h2 id="key-points">Key Points<a hidden class="anchor" aria-hidden="true" href="#key-points">#</a></h2>
<ol>
<li><strong>Evolution of Attack Methods</strong>: Beyond traditional analytical approaches such as statistical analysis, algebraic attacks (particularly Gröbner basis attacks) have been recognized by the academic community as significantly more effective and have become the primary research focus in recent years.</li>
<li><strong>Parameter Customization Challenges</strong>: Poseidon hash offers extensive customizable parameter space, which <strong>leads to issues of conservative security assumptions and potential overestimation</strong>.</li>
<li><strong>Current Research Status</strong>: The results provided by [ABM24] are excellent, but their acceptance in the community remains limited at present.</li>
</ol>
<p>In [GKR25], the authors present a comprehensive analysis of Gröbner basis attacks against Poseidon2 in Sponge mode through Table 5. This analysis is based on a two-step approach: the GB step (Macaulay bound) and the FGLM step (<code>conjectured dI</code>). Subsequently, the authors derive the minimum partial rounds values $r_P$ that can be configured, as shown in Table 3.</p>
<p><img loading="lazy" src="/images/GKR25_Table3.png"></p>
<p><img loading="lazy" src="/images/GKR25_Table5.png"></p>
<p><strong>Note</strong>: While the authors provide analysis data for both Sponge mode (Table 5) and Compress mode (Table 6), they only provide partial rounds settings similar to Table 3 for the Sponge mode. Based on the data from Table 6 and combining the Gröbner basis attack complexity formula $(d_{MAC})^{\omega}$ with $\omega = 2$ as used in Table 3, we perform the following calculations:</p>
<br>
<h2 id="security-threshold-calculation">Security Threshold Calculation<a hidden class="anchor" aria-hidden="true" href="#security-threshold-calculation">#</a></h2>
<p>To achieve 128-bit security, we need to satisfy:</p>
$$(d_{MAC})^2 \geq 2^{128}$$<p>Taking the square root of both sides, we get the requirement for the Macaulay Bound $d_{MAC}$:</p>
$$d_{MAC} \geq 2^{64}$$<p>Taking the logarithm, we obtain our required security threshold:</p>
$$\log_2(d_{MAC}) \geq 64$$<p>Any parameter configuration where $\log_2(d_{MAC})$ is greater than or equal to 64 can be considered secure against this attack.</p>
<br>
<h2 id="analysis-from-table-5">Analysis from Table 5<a hidden class="anchor" aria-hidden="true" href="#analysis-from-table-5">#</a></h2>
<p>Now, let&rsquo;s examine <strong>Table 5 (a) GB step</strong>. This table demonstrates how various complexity indicators change when the number of partial rounds $r_P$ increases from 1 to 5, for fixed parameters $t$, $d$, $c$. We focus particularly on the <strong>Macaulay bound d_MAC</strong> row, where the values in parentheses represent the pre-calculated $\log_2(d_{MAC})$ values.</p>
<p>Taking the first row of Table 5 as an example, with parameters $t=3$, $d=1$, $c=1$, $\ell=1$:</p>
<ul>
<li>When $r_P = 1$: $\log_2(d_{MAC}) = 27$ (&lt; 64, <strong>not secure</strong>)</li>
<li>When $r_P = 2$: $\log_2(d_{MAC}) = 33$ (&lt; 64, <strong>not secure</strong>)</li>
<li>When $r_P = 3$: $\log_2(d_{MAC}) = 51$ (&lt; 64, <strong>not secure</strong>)</li>
<li>When $r_P = 4$: $\log_2(d_{MAC}) = 87$ (&gt; 64, <strong>secure</strong>)</li>
<li>When $r_P = 5$: $\log_2(d_{MAC}) = 105$ (&gt; 64, <strong>secure</strong>)</li>
</ul>
<br>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>For the parameter set $t=3$, $d=1$, $c=1$, $\ell=1$, only 4 partial rounds are required to elevate the complexity of the most powerful Gröbner basis subspace optimization attack above the 128-bit security level.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://sidereushu.github.io/">Sidereus Hu</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
